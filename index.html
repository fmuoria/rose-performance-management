<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Quarterly Performance Scorecard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1100px;
            background: #fff;
            margin: 30px auto 30px auto;
            border-radius: 18px;
            box-shadow: 0 10px 32px rgba(80,60,120,0.15);
            padding: 36px 28px 30px 28px;
        }
        h1, h2 {
            text-align: center;
            color: #2c3e50;
            margin-top: 0;
        }
        .info-row {
            display: flex;
            gap: 30px;
            margin-bottom: 22px;
            flex-wrap: wrap;
        }
        .info-col {
            flex: 1;
            min-width: 220px;
        }
        label {
            font-weight: bold;
            color: #444;
        }
        .scorecard-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: #fafafa;
        }
        .scorecard-table th, .scorecard-table td {
            border: 1px solid #d1d5db;
            padding: 10px 8px;
            font-size: 1rem;
            vertical-align: top;
        }
        .scorecard-table th {
            background: #f2f6fa;
            color: #34495e;
            font-weight: bold;
        }
        .scorecard-section-header {
            background: #667eea;
            color: #fff;
            font-size: 1.1rem;
            letter-spacing: 0.05em;
        }
        .section-total-row {
            background: #e4e8f8;
            font-weight: bold;
        }
        .final-total-row {
            background: #27ae60;
            color: #fff;
            font-weight: bold;
            font-size: 1.12rem;
        }
        input[type="number"], select, textarea {
            font-size: 1rem;
            padding: 6px;
            width: 100%;
            border: 1.5px solid #e1e6ef;
            border-radius: 5px;
            background: #f8fafc;
            box-sizing: border-box;
            margin-top: 2px;
        }
        textarea {
            resize: vertical;
            min-height: 32px;
            max-height: 90px;
        }
        input[type="number"]:disabled, textarea:disabled {
            background: #f1f1f6;
            color: #999;
        }
        .legend, .score-summary {
            margin: 25px 0 5px 0;
            padding: 15px 18px;
            background: #fdf6e3;
            border-radius: 10px;
            color: #856404;
            font-size: 1rem;
        }
        .score-summary {
            background: #eafaf1;
            color: #1e824c;
            font-size: 1.08rem;
        }
        .btn-row {
            text-align: center;
            margin: 32px 0 14px 0;
        }
        button {
            background: linear-gradient(90deg, #667eea 70%, #764ba2 100%);
            color: #fff;
            font-weight: bold;
            font-size: 1rem;
            border: none;
            border-radius: 7px;
            padding: 12px 34px;
            margin: 7px 10px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(80,60,120,0.10);
            transition: transform 0.08s;
        }
        button:active {
            transform: scale(0.97);
        }
        .manager-comment {
            background: #f5faff;
            border-left: 4px solid #3498db;
            padding: 4px 8px;
            color: #2d3748;
        }
        @media (max-width: 900px) {
            .container { padding: 16px 2vw; }
            .info-row { flex-direction: column; gap: 10px;}
        }
        @media (max-width: 600px) {
            .container { padding: 7px 0; }
            .scorecard-table th, .scorecard-table td { font-size: 0.93rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quarterly Performance Scorecard</h1>
        <form id="scorecardForm" autocomplete="off">
            <div class="info-row">
                <div class="info-col">
                    <label>Employee's Name:</label><br>
                    <input type="text" id="employeeName" value="Dennis Chomba" required>
                </div>
                <div class="info-col">
                    <label>Job Title:</label><br>
                    <input type="text" id="employeeJob" value="IT Intern">
                </div>
                <div class="info-col">
                    <label>Division:</label><br>
                    <input type="text" id="division" value="Head office">
                </div>
                <div class="info-col">
                    <label>Immediate Manager:</label><br>
                    <input type="text" id="managerName" value="Francis Muoria">
                </div>
                <div class="info-col">
                    <label>Period:</label><br>
                    <input type="text" id="period" value="Q3 2025">
                </div>
            </div>
            <table class="scorecard-table" id="scorecardTable">
                <thead>
                    <tr>
                        <th style="width: 20%;">Dimension</th>
                        <th style="width: 24%;">Performance Measure</th>
                        <th style="width: 15%;">Target</th>
                        <th style="width: 18%;">Actual<br><span style="font-weight:normal;">(employee input)</span></th>
                        <th style="width: 8%;">Rating<br>(1-5)</th>
                        <th style="width: 7%;">Weight<br>(%)</th>
                        <th style="width: 10%;">Weighted<br>Average</th>
                        <th style="width: 20%;">Manager's Comments</th>
                    </tr>
                </thead>
                <tbody id="scorecardBody">
                    <!-- Financials -->
                    <tr class="scorecard-section-header"><td colspan="8">Financials</td></tr>
                    <tr>
                        <td>The individual should employ measures that help in reducing operational costs</td>
                        <td>Employing Cost cutting measures to ensure no organisation over spending, specifically on transport, airtime</td>
                        <td>Spend 2% less on org IT Budget</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="10" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr class="section-total-row"><td colspan="5">Financials Subtotal</td><td>10%</td><td id="financialsTotal"></td><td></td></tr>

                    <!-- Customer Perspective -->
                    <tr class="scorecard-section-header"><td colspan="8">Customer Perspective</td></tr>
                    <tr>
                        <td>The individual should display exemplary service to the customers (Internal or external) whom they work with/assist in day to day operations</td>
                        <td>Turnaround time of Service to internal Customers</td>
                        <td>Avg. response time: 24h (general), 1h (urgent), 6h (consultations)</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="10" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Relationship with Internal ROSE stakeholders</td>
                        <td>Minimal to no relationship complaints</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="10" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr class="section-total-row"><td colspan="5">Customer Perspective Subtotal</td><td>20%</td><td id="customerTotal"></td><td></td></tr>

                    <!-- Internal Business Processes -->
                    <tr class="scorecard-section-header"><td colspan="8">Internal Business Processes</td></tr>
                    <tr>
                        <td>Salesforce and Taroworks Management/Support</td>
                        <td>Percentage of reported issues resolved</td>
                        <td>100% issues resolved</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="10" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td>Digital Capacity Building Sessions (Trainers, Staff, Data Team)</td>
                        <td>Number of group sessions conducted monthly & percentage upskill in ROSE members</td>
                        <td>3 sessions/month, 70% upskill</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="15" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td>IT Maintenance and Troubleshooting</td>
                        <td>Frequency of scheduled maintenance & % device issues resolved</td>
                        <td>Quarterly, 90% device issues resolved</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="15" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td>Data Analysis</td>
                        <td>Number of audited monthly reports generated</td>
                        <td>2 reports biannually</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="5" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr class="section-total-row"><td colspan="5">Internal Business Processes Subtotal</td><td>45%</td><td id="internalTotal"></td><td></td></tr>

                    <!-- Learning and Growth -->
                    <tr class="scorecard-section-header"><td colspan="8">Learning and Growth</td></tr>
                    <tr>
                        <td></td>
                        <td>Hours of Career Development</td>
                        <td>40 hours learning in 6 months</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="5" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Business Continuity Planning</td>
                        <td>At least 1 trained individual who can relieve duties</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="5" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Innovations and Recommendations</td>
                        <td>1 innovation/quarter, 3 improvement recommendations</td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="5" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr class="section-total-row"><td colspan="5">Learning and Growth Subtotal</td><td>15%</td><td id="learningTotal"></td><td></td></tr>

                    <!-- Work Ethic -->
                    <tr class="scorecard-section-header"><td colspan="8">Work Ethic</td></tr>
                    <tr>
                        <td>Time management (Punctuality)</td>
                        <td>Reports for office meetings and functions on time</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Meets deadlines</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Shows up and works agreed-upon hours</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>

                    <tr>
                        <td>Integrity</td>
                        <td>Fosters trusting relationships with clients, coworkers and supervisors</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Supervisors rely on the employee's high moral standards</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>

                    <tr>
                        <td>Productivity</td>
                        <td>Does more than the bare minimum to deliver results to customers</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Cares about the quality of the work, not just the quantity of the work</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>

                    <tr>
                        <td>Professionalism</td>
                        <td>Complies with standard office attire</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Maintains a professional outlook</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Adheres to Standard Operating Procedures</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Takes responsibility and ownership of assigned role</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>

                    <tr>
                        <td>Teamwork</td>
                        <td>Takes responsibility for other people’s welfare</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Fair and objective treatment of other staff members</td>
                        <td></td>
                        <td><textarea name="actual"></textarea></td>
                        <td><input type="number" min="1" max="5" step="0.1" name="rating" required></td>
                        <td><input type="number" name="weight" value="0.8" disabled></td>
                        <td><input type="number" name="weighted" step="0.001" disabled></td>
                        <td><textarea name="managerComment" disabled></textarea></td>
                    </tr>
                    <tr class="section-total-row"><td colspan="5">Work Ethic Subtotal</td><td>10%</td><td id="workEthicTotal"></td><td></td></tr>
                    <!-- Final total row -->
                    <tr class="final-total-row"><td colspan="6">TOTAL SCORE</td><td id="finalTotal"></td><td></td></tr>
                </tbody>
            </table>
            <div class="btn-row">
                <button type="button" onclick="saveScorecard()">Save</button>
                <button type="reset">Reset</button>
            </div>
        </form>
        <div class="score-summary" id="scoreSummary"></div>
        <div class="legend">
            <b>Score Legend:</b><br>
            1.00–1.99 Not met; &nbsp; 2.00–2.99 Partially met; &nbsp; 3.00–3.99 Met; &nbsp; 4.00–4.99 Generally Exceeding; &nbsp; 5.00 Exceeded by far
        </div>
    </div>
    <script>
        // Get all rows that have input fields for ratings, weights, weighted
        const scorecardBody = document.getElementById('scorecardBody');
        const rows = Array.from(scorecardBody.querySelectorAll('tr')).filter(tr =>
            tr.querySelector('input[name="rating"]')
        );

        function calcWeighted(rating, weight) {
            if (isNaN(rating) || isNaN(weight)) return '';
            return +(rating * (weight / 100)).toFixed(3);
        }

        // Calculate and update all weighted average fields, subtotals, and total
        function updateCalculations() {
            let sectionSums = {
                financials: 0,
                customer: 0,
                internal: 0,
                learning: 0,
                workEthic: 0
            };
            let sectionWeights = {
                financials: 10,
                customer: 20,
                internal: 45,
                learning: 15,
                workEthic: 10
            };

            let sectionMap = [
                { name: 'financials', start: 0, end: 1 },
                { name: 'customer', start: 1, end: 3 },
                { name: 'internal', start: 3, end: 7 },
                { name: 'learning', start: 7, end: 10 },
                { name: 'workEthic', start: 10, end: rows.length }
            ];

            // For each row with rating and weight, update weighted
            rows.forEach((tr, idx) => {
                const ratingInput = tr.querySelector('input[name="rating"]');
                const weightInput = tr.querySelector('input[name="weight"]');
                const weightedInput = tr.querySelector('input[name="weighted"]');
                const rating = parseFloat(ratingInput.value) || 0;
                const weight = parseFloat(weightInput.value) || 0;
                const weighted = calcWeighted(rating, weight);
                weightedInput.value = weighted || '';
            });

            // Section subtotals
            sectionMap.forEach(section => {
                let subtotal = 0;
                for (let i = section.start; i < section.end; ++i) {
                    const weighted = parseFloat(rows[i].querySelector('input[name="weighted"]').value) || 0;
                    subtotal += weighted;
                }
                document.getElementById(section.name.charAt(0).toLowerCase() + section.name.slice(1) + "Total").textContent = subtotal ? subtotal.toFixed(3) : '';
                sectionSums[section.name] = subtotal;
            });

            // Final total
            let finalTotal = Object.values(sectionSums).reduce((a,b) => a+b, 0);
            document.getElementById('finalTotal').textContent = finalTotal ? finalTotal.toFixed(3) : '';
            // Score summary
            let category = '';
            if (finalTotal >= 5) category = "Exceeded by far";
            else if (finalTotal >= 4) category = "Generally Exceeding";
            else if (finalTotal >= 3) category = "Met";
            else if (finalTotal >= 2) category = "Partially met";
            else if (finalTotal > 0) category = "Not met";
            document.getElementById('scoreSummary').textContent = finalTotal ? `Your overall quarterly score is ${finalTotal.toFixed(2)}. Category: ${category}.` : '';
        }

        // Attach listeners to all rating fields
        rows.forEach(tr => {
            const ratingInput = tr.querySelector('input[name="rating"]');
            ratingInput.addEventListener('input', updateCalculations);
        });

        // Run once on load to fill any prefilled data
        updateCalculations();

        // Save to localStorage (for demo purposes)
        function saveScorecard() {
            const data = {
                employee: document.getElementById('employeeName').value,
                job: document.getElementById('employeeJob').value,
                division: document.getElementById('division').value,
                manager: document.getElementById('managerName').value,
                period: document.getElementById('period').value,
                rows: rows.map(tr => ({
                    dimension: tr.children[0].textContent,
                    measure: tr.children[1].textContent,
                    target: tr.children[2].textContent,
                    actual: tr.querySelector('textarea[name="actual"]').value,
                    rating: tr.querySelector('input[name="rating"]').value,
                    weight: tr.querySelector('input[name="weight"]').value,
                    weighted: tr.querySelector('input[name="weighted"]').value,
                    managerComment: tr.querySelector('textarea[name="managerComment"]').value
                }))
            };
            localStorage.setItem('quarterlyScorecard', JSON.stringify(data));
            alert('Scorecard saved locally (demo only).');
        }
    </script>
</body>
</html>
